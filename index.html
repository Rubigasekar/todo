<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>To-Do — Get Things Done</title>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --muted:#9aa7b2;
      --accent1:#06b6d4; /* cyan */
      --accent2:#7c3aed; /* purple */
      --glass: rgba(255,255,255,0.04);
      --success:#10b981;
      --danger:#ef4444;
      --radius:14px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:url('https://images.unsplash.com/photo-1506784983877-45594efa4cbe?auto=format&fit=crop&w=1950&q=80') no-repeat center center fixed;background-size:cover;color:#e6eef6}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:48px;background:rgba(15,23,36,0.85)}
    .card{width:100%;max-width:760px;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));border-radius:var(--radius);padding:28px;box-shadow:0 8px 30px rgba(2,6,23,0.7);border:1px solid rgba(255,255,255,0.05)}
    header{display:flex;align-items:center;gap:18px;margin-bottom:18px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;color:white;box-shadow:0 6px 20px rgba(124,58,237,0.18)}
    h1{font-size:20px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .input-row{display:flex;gap:12px;margin-top:14px;flex-wrap:wrap}
    .task-input{flex:2;background:var(--glass);border:1px solid rgba(255,255,255,0.08);padding:12px 14px;border-radius:12px;color:inherit;font-size:15px;outline:none}
    .task-input::placeholder{color:rgba(230,238,246,0.45)}
    .task-date{flex:1;background:var(--glass);border:1px solid rgba(255,255,255,0.08);padding:12px 14px;border-radius:12px;color:inherit;font-size:15px;outline:none}
    .btn{background:linear-gradient(90deg,var(--accent1),var(--accent2));border:none;color:white;padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(7,16,30,0.6)}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);box-shadow:none}

    .controls{display:flex;justify-content:space-between;align-items:center;margin-top:18px}
    .filters{display:flex;gap:8px}
    .filter{padding:8px 12px;border-radius:10px;background:transparent;border:1px solid transparent;color:var(--muted);cursor:pointer}
    .filter.active{background:linear-gradient(90deg, rgba(124,58,237,0.12), rgba(6,182,212,0.08));color:var(--accent2);border-color:rgba(255,255,255,0.04)}

    ul.tasks{list-style:none;padding:0;margin:18px 0 8px 0}
    li.task{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;margin-bottom:8px;background:linear-gradient(180deg, rgba(255,255,255,0.03), transparent);border:1px solid rgba(255,255,255,0.05)}
    .checkbox{width:22px;height:22px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);display:flex;align-items:center;justify-content:center;cursor:pointer}
    .checkbox.checked{background:linear-gradient(90deg,var(--success), #059669);border:none;color:white}
    .content{flex:1}
    .content .title{font-weight:600}
    .content .meta{font-size:12px;color:var(--muted);margin-top:4px}
    .actions{display:flex;gap:8px}
    .icon-btn{border:none;background:transparent;color:var(--muted);cursor:pointer;padding:8px;border-radius:8px}
    .icon-btn:hover{background:rgba(255,255,255,0.04);color:inherit}

    .empty{padding:28px;border-radius:12px;text-align:center;color:var(--muted);background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border:1px dashed rgba(255,255,255,0.05)}
    footer{display:flex;justify-content:space-between;align-items:center;margin-top:10px;color:var(--muted);font-size:13px}

    @media (max-width:560px){.card{padding:18px}.logo{width:52px;height:52px}.input-row{flex-direction:column}.btn{width:100%}}

    .task-enter{animation:pop .12s ease}
    @keyframes pop{from{transform:translateY(-6px);opacity:0}to{transform:none;opacity:1}}

    .done .title{text-decoration:line-through;color:rgba(230,238,246,0.55)}
  </style>
</head>
<body>
  <div class="wrap">
    <main class="card" role="application">
      <header>
        <div class="logo">TD</div>
        <div>
          <h1>To-Do — You’ve Got This</h1>
          <p class="lead">Plan smart, assign dates, and achieve decisively.</p>
        </div>
      </header>

      <div>
        <div class="input-row">
          <input id="taskInput" class="task-input" type="text" placeholder="Add your next task..." aria-label="Add new task" />
          <input id="taskDate" class="task-date" type="date" aria-label="Select due date" />
          <button id="addBtn" class="btn">Add Task</button>
        </div>

        <div class="controls">
          <div class="filters" role="tablist" aria-label="Filter tasks">
            <button class="filter active" data-filter="all">All</button>
            <button class="filter" data-filter="active">Active</button>
            <button class="filter" data-filter="completed">Completed</button>
          </div>
          <div>
            <button id="clearCompleted" class="btn ghost">Clear completed</button>
          </div>
        </div>

        <ul id="tasks" class="tasks" aria-live="polite"></ul>

        <div id="emptyState" class="empty" hidden>
          <strong>No tasks yet.</strong>
          <div style="margin-top:8px">Start by adding your first task with a date — one action leads to progress.</div>
        </div>

        <footer>
          <div id="count">0 tasks</div>
          <div style="display:flex;gap:8px;align-items:center">
            <button id="selectAll" class="btn ghost">Mark all done</button>
          </div>
        </footer>
      </div>
    </main>
  </div>

  <script>
    const STORAGE_KEY = 'confident-todo-v2'
    const taskInput = document.getElementById('taskInput')
    const taskDate = document.getElementById('taskDate')
    const addBtn = document.getElementById('addBtn')
    const tasksEl = document.getElementById('tasks')
    const emptyState = document.getElementById('emptyState')
    const filters = document.querySelectorAll('.filter')
    const clearCompletedBtn = document.getElementById('clearCompleted')
    const countEl = document.getElementById('count')
    const selectAllBtn = document.getElementById('selectAll')

    let tasks = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]')
    let filter = 'all'

    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks)) }

    function render(){
      tasksEl.innerHTML = ''
      const filtered = tasks.filter(t => filter === 'all' ? true : (filter === 'active' ? !t.done : t.done))
      if(filtered.length === 0){
        emptyState.hidden = tasks.length !== 0
        if(tasks.length === 0) emptyState.hidden = false
      } else { emptyState.hidden = true }

      filtered.forEach(task => {
        const li = document.createElement('li')
        li.className = 'task task-enter' + (task.done ? ' done' : '')
        li.dataset.id = task.id

        const cb = document.createElement('div')
        cb.className = 'checkbox' + (task.done ? ' checked' : '')
        cb.innerHTML = task.done ? '✓' : ''
        cb.addEventListener('click', () => toggleDone(task.id))

        const content = document.createElement('div')
        content.className = 'content'
        const title = document.createElement('div')
        title.className = 'title'
        title.textContent = task.title
        const meta = document.createElement('div')
        meta.className = 'meta'
        meta.textContent = `Due: ${task.dueDate ? new Date(task.dueDate).toLocaleDateString() : 'No date'} | Added: ${new Date(task.createdAt).toLocaleString()}`

        content.appendChild(title)
        content.appendChild(meta)

        const actions = document.createElement('div')
        actions.className = 'actions'
        const editBtn = document.createElement('button')
        editBtn.className = 'icon-btn'
        editBtn.innerText = 'Edit'
        editBtn.addEventListener('click', () => editTask(task.id))
        const delBtn = document.createElement('button')
        delBtn.className = 'icon-btn'
        delBtn.innerText = 'Delete'
        delBtn.addEventListener('click', () => removeTask(task.id))

        actions.appendChild(editBtn)
        actions.appendChild(delBtn)

        li.appendChild(cb)
        li.appendChild(content)
        li.appendChild(actions)
        tasksEl.appendChild(li)
      })

      countEl.textContent = `${tasks.filter(t => !t.done).length} active • ${tasks.length} total`
    }

    function addTask(title, dueDate){
      const trimmed = title && title.trim()
      if(!trimmed) return
      tasks.unshift({id:Date.now().toString(), title:trimmed, done:false, createdAt: Date.now(), dueDate, notified:false})
      save(); render(); taskInput.value=''; taskDate.value=''; taskInput.focus()
    }

    function removeTask(id){ tasks = tasks.filter(t => t.id !== id); save(); render() }

    function toggleDone(id){ tasks = tasks.map(t => t.id === id ? {...t, done: !t.done} : t); save(); render() }

    function editTask(id){
      const task = tasks.find(t => t.id === id)
      if(!task) return
      const newTitle = prompt('Edit task title', task.title)
      if(newTitle === null) return
      const trimmed = newTitle.trim()
      if(!trimmed) return alert('Task cannot be empty.')
      const newDate = prompt('Edit due date (YYYY-MM-DD)', task.dueDate || '')
      task.title = trimmed
      if(newDate) task.dueDate = newDate
      save(); render()
    }

    addBtn.addEventListener('click', () => addTask(taskInput.value, taskDate.value))
    taskInput.addEventListener('keydown', (e) => { if(e.key === 'Enter') addTask(taskInput.value, taskDate.value) })

    filters.forEach(f => f.addEventListener('click', () => {
      filters.forEach(x=>x.classList.remove('active'))
      f.classList.add('active')
      filter = f.dataset.filter
      render()
    }))

    clearCompletedBtn.addEventListener('click', () => {
      if(!confirm('Clear all completed tasks?')) return
      tasks = tasks.filter(t => !t.done)
      save(); render()
    })

    selectAllBtn.addEventListener('click', () => {
      const allDone = tasks.every(t => t.done)
      tasks = tasks.map(t => ({...t, done: !allDone}))
      save(); render()
    })

    // --- Notifications ---
    if ("Notification" in window && Notification.permission !== "granted") {
      Notification.requestPermission();
    }

    // Check every 30s for tasks due today
    setInterval(() => {
      const now = new Date();
      tasks.forEach(task => {
        if (task.dueDate && !task.done && !task.notified) {
          const dueDate = new Date(task.dueDate);
          if (
            dueDate.getFullYear() === now.getFullYear() &&
            dueDate.getMonth() === now.getMonth() &&
            dueDate.getDate() === now.getDate()
          ) {
            if (Notification.permission === "granted") {
              new Notification("Task Due Today!", {
                body: task.title,
                icon: "https://cdn-icons-png.flaticon.com/512/3176/3176362.png"
              });
            }
            task.notified = true;
            save();
          }
        }
      });
    }, 30000);

    render()
    console.log('%cConfident To-Do v2 Loaded — with due dates & notifications!', 'color: #06b6d4; font-weight:700')
  </script>
</body>
</html>
